<html>
<head>
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />

    <link rel="stylesheet" href="css/bootstrap.min.css?1" />
    <link rel="stylesheet" href="css/common.css?1" />
    <script type="text/javascript" src="js/jquery.min.js?1"></script>
    <script type="text/javascript" src="js/bootstrap.min.js?1"></script>
    <script type="text/javascript" src="js/common.js?2"></script>
    <script type="text/javascript" src="js/classes.js?1"></script>
    <style type="text/css">
        @media screen and (min-width: 1300px) {
            .app-title {
                display: block;
            }
        }

        body {
            background-color: #ddd;
            margin: 0;
            padding: 0;
        }
    </style>
    <script type="text/javascript">
        $(document).ready(() => {
            $("input[type=number]").blur(function () {
                var self = $(this);
                val = parseFloat(self.val());
                min = parseFloat(self.attr("min"));
                max = parseFloat(self.attr("max"));
                if (val > max) {
                    self.val(max);
                } else if (val < min) {
                    self.val(min);
                }
                try {
                    eval(self.attr("lazyblur"));
                } catch (e) {
                    console.log(e);
                }
            });
            CreateToggles();
            ConfigureCanvas();
            ResetCanvas();
        });

        function ResetCanvas() {
            requestAnimationFrame(ResetCanvas);

            canvasObj.width = window.innerWidth;
            canvasObj.height = window.innerHeight;
            currentDarken = getFloat("numGlobalShow");
            var cmpX = getInt("numCompX");
            var cmpY = getInt("numCompY");
            var rott = chkVal("chkHorizontal");
            var grid = chkVal("chkShowGrid");
            var cord = chkVal("chkShowCoords");
            var slrs = chkVal("chkShowAllLayer");
            var back = $("#numColorBk").val();

            //Zoom and Box Settings
            AMMOUNT = getInt("numBox");
            var ammountWZ = AMMOUNT * cameraZoom;
            var currX = currentX + cmpX;
            var currY = currentY + cmpY;

            //Parallax settings
            showAnimation = chkVal("chkParallaxAnim");
            parallaxDirection = chkVal("chkParallaxRtl");
            parallaxVertical = chkVal("chkParallaxVertical");
            parallaxSpeed = getFloat("numkParallaxSpeed");
            parallaxX = getInt("numParallaxX");
            parallaxY = getInt("numParallaxY");
            parallaxOp = getFloat("numParallaxOp");
            parallaxStretch = chkVal("chkParallaxStretch");

            //Background Color
            canvasCtx.fillStyle = back;
            canvasCtx.fillRect(0, 0, canvasObj.width, canvasObj.height);

            if (rott) {
                var centerX = (currentImg.width) / 2;
                var centerY = (currentImg.height) / 2;
                canvasCtx.translate(centerX, centerY);
                canvasCtx.rotate((90 * Math.PI) / 180);
                canvasCtx.translate(-centerX, -centerY);
            }

            //Parallax
            RenderParallax();

            //Background
            canvasCtx.drawImage(currentImg, currX, currY, currentImg.width * cameraZoom, currentImg.height * cameraZoom);

            //Layers
            if (slrs) {
                layers.forEach((layer) => {
                    layer.draw(canvasCtx, currX, currY);
                });
            }

            //Reveals
            RenderRevealCreate(currX, currY, ammountWZ);
            RenderRevealList(currX, currY, ammountWZ);

            if (rott) canvasCtx.setTransform(1, 0, 0, 1, 0, 0);

            //Fade
            RenderOverlay();

            //Grid and Coords
            RenderGridAndCoords(grid, cord);
        }

        function RenderOverlay() {
            if (currentDarken > 0) {
                canvasCtx.save();
                canvasCtx.fillStyle = `rgba(0, 0, 0, ${currentDarken})`;
                canvasCtx.fillRect(0, 0, canvasObj.width, canvasObj.height);
                canvasCtx.restore();
            }
        }

        function RenderGridAndCoords(grid, cord) {
            var stepsV = (window.innerWidth / AMMOUNT) + 1;
            var stepsH = (window.innerHeight / AMMOUNT) + 1;
            canvasCtx.save();
            if (grid) {
                for (var i = 0; i < stepsV; i++) {
                    if (i > 0) {
                        var pos = (i * AMMOUNT) - 1;
                        DrawVerLine(pos);
                    }
                }
                for (var j = 0; j < stepsH; j++) {
                    if (j > 0) {
                        var pos = (j * AMMOUNT) - 1;
                        DrawHorLine(pos);
                    }
                }
            }
            if (cord) DrawCoordsFull(stepsV, stepsH);
            canvasCtx.restore();
        }

        function RenderRevealCreate(currX, currY, ammountWZ) {
            if (createMapRevealEnabled) {
                var cc = hexToRgb($("#numColor").val());
                canvasCtx.fillStyle = `rgba(${cc.r}, ${cc.g}, ${cc.b}, 0.5)`;
                canvasCtx.fillRect((lastMouseX * AMMOUNT), (lastMouseY * AMMOUNT), AMMOUNT, AMMOUNT);

                canvasCtx.save();
                canvasCtx.fillStyle = $("#numColorMapReveal").val();
                currentRevealSteps.forEach((obj) => {
                    canvasCtx.fillRect(currX + (obj.x * ammountWZ), currY + (obj.y * ammountWZ), ammountWZ, ammountWZ);
                });
                canvasCtx.restore();
            }
        }

        function RenderRevealList(currX, currY, ammountWZ) {
            var showAll = chkVal("chkShowAllMapReveal");
            if (!showAll) return;
            if (currentRevealList.length > 0) {
                canvasCtx.save();
                var stepColor = $("#numColorMapReveal").val();
                canvasCtx.fillStyle = stepColor;
                var drawNames = chkVal("chkShowMapRevealNames");
                canvasCtx.font = `bold ${(parseInt(ammountWZ) - 4)}px Arial`;
                if (createMapRevealEnabled) {
                    canvasCtx.globalAlpha = 0.5;
                }
                currentRevealList.forEach((rev) => {
                    if (JSON.stringify(rev) === JSON.stringify(currentSelectedRevealItem) && createMapRevealEnabled) return;
                    if (rev.visible) {
                        rev.steps.forEach((obj) => {
                            var propX = CalcProportion(rev.Proportion, obj.x, AMMOUNT);
                            var propY = CalcProportion(rev.Proportion, obj.y, AMMOUNT);
                            canvasCtx.fillRect(currX + (propX * ammountWZ), currY + (propY * ammountWZ), ammountWZ, ammountWZ);
                        });
                        if (drawNames) {
                            canvasCtx.save();
                            var pos = rev.steps[0];
                            var propX = CalcProportion(rev.Proportion, pos.x, AMMOUNT);
                            var propY = CalcProportion(rev.Proportion, pos.y, AMMOUNT);
                            canvasCtx.fillStyle = invertColor(stepColor);
                            canvasCtx.fillText(rev.name, (currX + (propX * ammountWZ)) + 4, (currY + (propY * ammountWZ)) + (ammountWZ - 8));
                            canvasCtx.restore();
                        }
                    }
                });
                canvasCtx.restore();
            }
        }

        function ExecuteCommand(cmd) {
            var rott = $("#chkHorizontal").prop("checked");
            switch (cmd) {
                case 0: //BX+
                    AddValueToField("#numBox", 1, parseInt);
                    ResetCanvas();
                    break;
                case 1: //BX-
                    AddValueToField("#numBox", -1, parseInt);
                    ResetCanvas();
                    break;
                case 2: //ZM+
                    AddValueToField("#numCompZ", 0.01, parseFloat);
                    SetCanvasZoom();
                    break;
                case 3: //ZM-
                    AddValueToField("#numCompZ", -0.01, parseFloat);
                    SetCanvasZoom();
                    break;
                case 4: //CX+
                    AddValueToField("#numCompX", 1, parseInt);
                    ResetCanvas();
                    break;
                case 5: //CX-
                    AddValueToField("#numCompX", -1, parseInt);
                    ResetCanvas();
                    break;
                case 6: //CY+
                    AddValueToField("#numCompY", 1, parseInt);
                    ResetCanvas();
                    break;
                case 7: //CY-
                    AddValueToField("#numCompY", -1, parseInt);
                    ResetCanvas();
                    break;

                case 8: //Up
                    ExecuteMove(Keys.Up, false, true, rott);
                    ResetCanvas();
                    break;
                case 9: //Down
                    ExecuteMove(Keys.Down, false, true, rott);
                    ResetCanvas();
                    break;
                case 10: //Left
                    ExecuteMove(Keys.Left, false, true, rott);
                    ResetCanvas();
                    break;
                case 11: //Right
                    ExecuteMove(Keys.Right, false, true, rott);
                    ResetCanvas();
                    break;

                case 12: //Configure Objects
                    ShowHideObjectPanel(false);
                    break;

                case 13: //Layers
                    ShowHideLayerPanel(false);
                    break;

                case 14: //Map Reveal
                    ShowHideMapRevealPanel(false);
                    break;

                default:
                    alert("Not Implemented Yet.");
                    break;
            }
        }
    </script>
</head>
<body>
    <div>
        <div style="display: none">
            <input type="file" id="uploadFile" accept="image/*" />
            <input type="file" id="uploadSettings" accept=".json" />
            <canvas id="saveCanvas"></canvas>
        </div>
        <table style="width: calc(100% - 10px); margin-top: 4px; ">
            <tr>
                <td>
                    <div class="app-title">Deploy Games Simple Virtual TableTop</div>
                </td>
                <td style="width: 8px">&nbsp;</td>
                <td style="width: 158px">
                    <div class="input-group input-group-sm">
                        <div class="input-group-btn">
                            <div class="btn-group btn-group-sm">
                                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <i class="glyphicon glyphicon-cog"></i>&nbsp;Settings&nbsp;<span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu" style="min-width: 50px !important;z-index: 2000">
                                    <li><a onclick="ExecuteCommand(12)"><i class="glyphicon glyphicon-cog"></i>&nbsp;Settings</a></li>
                                    <li><a onclick="ExecuteCommand(13)"><i class="glyphicon glyphicon-list-alt"></i>&nbsp;Layers</a></li>
                                    <li><a onclick="ExecuteCommand(14)"><i class="glyphicon glyphicon-eye-close"></i>&nbsp;Map Reveals</a></li>
                                    <li><a onclick="ExecuteCommand(15)"><i class="glyphicon glyphicon-film"></i>&nbsp;Animations</a></li>
                                    <li><a onclick="ShowSettingsWindow()"><i class="glyphicon glyphicon-th"></i>&nbsp;Control Panel</a></li>
                                </ul>
                            </div>
                            <a class="btn btn-default" onclick="WriteSettings()" title="Save Settings">
                                <i class="glyphicon glyphicon-save"></i>&nbsp;Save
                            </a>
                            <a class="btn btn-default" onclick="ReadSettings()" title="Load Settings">
                                <i class="glyphicon glyphicon-open"></i>&nbsp;Open
                            </a>
                        </div>
                    </div>
                </td>
            </tr>
        </table>
    </div>
    <div class="right-bar">
        <div class="btn-group btn-group-vertical">
            <a class="btn btn-default btnl-lg" onclick="ExecuteCommand(8)">
                <i class="glyphicon glyp-adj glyphicon-arrow-up"></i>
            </a>
            <a class="btn btn-default btnl-lg" onclick="ExecuteCommand(9)">
                <i class="glyphicon glyp-adj glyphicon-arrow-down"></i>
            </a>
            <a class="btn btn-default btnl-lg" onclick="ExecuteCommand(10)">
                <i class="glyphicon glyp-adj glyphicon-arrow-left"></i>
            </a>
            <a class="btn btn-default btnl-lg" onclick="ExecuteCommand(11)">
                <i class="glyphicon glyp-adj glyphicon-arrow-right"></i>
            </a>
            <a class="btn btn-default btnl-lg" onclick="ExecuteCommand(0)">BX+</a>
            <a class="btn btn-default btnl-lg" onclick="ExecuteCommand(1)">BX-</a>
            <a class="btn btn-default btnl-lg" onclick="ExecuteCommand(2)">ZM+</a>
            <a class="btn btn-default btnl-lg" onclick="ExecuteCommand(3)">ZM-</a>
            <a class="btn btn-default btnl-lg" onclick="ExecuteCommand(4)">CX+</a>
            <a class="btn btn-default btnl-lg" onclick="ExecuteCommand(5)">CX-</a>
            <a class="btn btn-default btnl-lg" onclick="ExecuteCommand(6)">CY+</a>
            <a class="btn btn-default btnl-lg" onclick="ExecuteCommand(7)">CY-</a>
        </div>
    </div>

    <div id="mapRevealPanel" class="object-panel map-reveal-panel" style="display: none">
        <table style="width: 100%;">
            <tr>
                <td><label class="lbl-header">Map Reveal Steps</label></td>
            </tr>
            <tr>
                <td style="text-align: right">
                    <div class="input-group input-group-sm">
                        <span class="input-group-addon addon-60p" style="font-weight: bold" title="Reveal Items Color">Color:</span>
                        <input type="color" class="form-control input-sm" id="numColorMapReveal" value="#ffffff" oninput="ResetCanvas()" />
                        <div class="input-group-btn">
                            <a class="btn btn-default" onclick="AddRevealItem()" title="Add Item">
                                <i class="glyphicon glyphicon-plus-sign"></i>&nbsp;Add
                            </a>
                            <a class="btn btn-default" onclick="CloneRevealItem()" title="Clone Item">
                                <i class="glyphicon glyphicon-copy"></i>&nbsp;Cln
                            </a>
                            <a class="btn btn-default" onclick="EditRevealItem()" title="Edit Item">
                                <i class="glyphicon glyphicon-pencil"></i>&nbsp;Edt
                            </a>
                            <a class="btn btn-default" onclick="DeleteRevealItem()" title="Delete Item">
                                <i class="glyphicon glyphicon-remove"></i>&nbsp;Del
                            </a>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div style="margin-top: 5px"></div>
                    <table style="width: 100%">
                        <tr>
                            <td id="tdShowMapRevealNames"></td>
                            <td id="tdShowAllMapReveal" style="text-align: right"></td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td>
                    <table style="width: 100%">
                        <tr>
                            <td>
                                <select multiple id="lstMapReveals" class="form-control input-sm" style="height: 232px"
                                        ondblclick="ChangeCurrentMapReveal()"></select>
                            </td>
                            <td style="width: 40px">
                                <div class="btn-group btn-group-vertical">
                                    <a class="btn btn-sm-adj btn-default" onclick="MoveRevealItem(0)" title="Move Map Up">
                                        <i class="glyphicon glyp-adj glyphicon-arrow-up"></i>
                                    </a>
                                    <a class="btn btn-sm-adj btn-default" onclick="MoveRevealItem(1)" title="Move Map Down">
                                        <i class="glyphicon glyp-adj glyphicon-arrow-down"></i>
                                    </a>
                                    <a class="btn btn-sm-adj btn-default" onclick="MoveRevealItem(2)" title="Move Map Left">
                                        <i class="glyphicon glyp-adj glyphicon-arrow-left"></i>
                                    </a>
                                    <a class="btn btn-sm-adj btn-default" onclick="MoveRevealItem(3)" title="Move Map Right">
                                        <i class="glyphicon glyp-adj glyphicon-arrow-right"></i>
                                    </a>
                                </div>
                                <div class="btn-group btn-group-vertical">
                                    <a class="btn btn-default" style="height: 50px" onclick="MoverRevealUp()" title="Move List Up">
                                        <i class="glyphicon glyphicon-triangle-top"></i>
                                    </a>
                                    <a class="btn btn-default" style="height: 50px" onclick="MoverRevealDown()" title="Move List Down">
                                        <i class="glyphicon glyphicon-triangle-bottom" style="top: 20px;"></i>
                                    </a>
                                </div>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </div>

    <div class="object-panel layer-panel" id="layersPanel" style="display: none">
        <table style="width: 100%;">
            <tr>
                <td><label class="lbl-header">Layers</label></td>
            </tr>
            <tr>
                <td>
                    <table style="width: 100%">
                        <tr>
                            <td id="tdShowAllLayer"></td>
                            <td style="text-align: right; vertical-align: baseline;">
                                <div class="input-group input-group-sm">
                                    <div class="input-group-btn">
                                        <a class="btn btn-default" onclick="AddLayer()" title="Add Layer">
                                            <i class="glyphicon glyphicon-plus-sign"></i>&nbsp;Add
                                        </a>
                                        <a class="btn btn-default" onclick="CloneLayer()" title="Clone Layer">
                                            <i class="glyphicon glyphicon-copy"></i>&nbsp;Cln
                                        </a>
                                        <a class="btn btn-default" onclick="DeleteLayer()" title="Delete Layer">
                                            <i class="glyphicon glyphicon-remove"></i>&nbsp;Del
                                        </a>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td>
                    <table style="width: 100%">
                        <tr>
                            <td>
                                <select multiple id="lstLayers" class="form-control input-sm" style="height: 100px;" ondblclick="SelectCurrentLayer()"></select>
                            </td>
                            <td style="width: 40px">
                                <div class="btn-group btn-group-vertical">
                                    <a class="btn btn-default" style="height: 50px" onclick="MoverLayerUp()" title="Move Up">
                                        <i class="glyphicon glyphicon-triangle-top"></i>
                                    </a>
                                    <a class="btn btn-default" style="height: 50px" onclick="MoverLayerDown()" title="Move Down">
                                        <i class="glyphicon glyphicon-triangle-bottom" style="top: 20px;"></i>
                                    </a>
                                </div>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td>
                    <table style="width: 100%;">
                        <tr>
                            <td colspan="3">
                                <div class="input-group input-group-sm">
                                    <span class="input-group-addon addon-74p" style="font-weight: bold">Name:</span>
                                    <input type="text" class="form-control input-sm" id="txtLayerName" lazyblur="UpdateSelectedLayer()" />
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td style="width: 150px">
                                <div class="input-group input-group-sm">
                                    <span class="input-group-addon addon-74p" style="font-weight: bold">X:</span>
                                    <input type="number" class="form-control input-sm" min="-960" step="1" id="numLayerX" value="0" lazyblur="UpdateSelectedLayer()" />
                                </div>
                            </td>
                            <td style="width: 8px">&nbsp;</td>
                            <td>
                                <div class="input-group input-group-sm">
                                    <span class="input-group-addon addon-74p" style="font-weight: bold">Y:</span>
                                    <input type="number" class="form-control input-sm" min="-960" step="1" id="numLayerY" value="0" lazyblur="UpdateSelectedLayer()" />
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="input-group input-group-sm">
                                    <span class="input-group-addon addon-74p" style="font-weight: bold">Width:</span>
                                    <input type="number" class="form-control input-sm" min="0" step="1" id="numLayerW" value="0" lazyblur="UpdateSelectedLayer()" />
                                </div>
                            </td>
                            <td style="width: 8px">&nbsp;</td>
                            <td>
                                <div class="input-group input-group-sm">
                                    <span class="input-group-addon addon-74p" style="font-weight: bold">Height:</span>
                                    <input type="number" class="form-control input-sm" min="0" step="1" id="numLayerH" value="0" lazyblur="UpdateSelectedLayer()" />
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="input-group input-group-sm">
                                    <span class="input-group-addon addon-74p" style="font-weight: bold">Opacity:</span>
                                    <div class="form-control input-sm">
                                        <input type="range" min="0" max="1" step="0.1" id="numLayerOp" value="1" oninput="UpdateSelectedLayer()" />
                                    </div>
                                </div>
                            </td>
                            <td style="width: 8px">&nbsp;</td>
                            <td>
                                <div class="input-group input-group-sm">
                                    <span class="input-group-addon addon-74p" style="font-weight: bold">Flip:</span>
                                    <select class="form-control input-sm" id="lstFlipLayer" onchange="UpdateSelectedLayer()">
                                        <option value="0">None</option>
                                        <option value="1">Horizontal</option>
                                        <option value="2">Vertical</option>
                                        <option value="3">Both</option>
                                    </select>
                                </div>
                            </td>
                        </tr>
                    </table>
                    <table style="width: 100%;margin-top: 5px">
                        <tr>
                            <td id="tdShowLayerOverlay"></td>
                            <td style="width: 8px">&nbsp;</td>
                            <td style="text-align: right; vertical-align: baseline; ">
                                <div class="input-group input-group-sm" title="Overlay Opacity">
                                    <span class="input-group-addon addon-74p" style="font-weight: bold">O.Opacity:</span>
                                    <div class="form-control input-sm">
                                        <input type="range" min="0" max="1" step="0.1" id="numLayerOverlayOp" value="1" oninput="UpdateSelectedLayer()" />
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </table>
                    <table style="width: 100%;">
                        <tr>
                            <td id="tdShowLayer" style="width: 170px"></td>
                            <td style="width: 8px">&nbsp;</td>
                            <td style="vertical-align: baseline;">
                                <div class="input-group input-group-sm" title="Overlay Color">
                                    <span class="input-group-addon addon-60p" style="font-weight: bold">O.Color:</span>
                                    <input type="color" class="form-control input-sm" id="numColorLayerOverlay" value="#000000" oninput="UpdateSelectedLayer()" />
                                </div>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </div>

    <div class="object-panel" id="objectPanel" style="display: none">
        <table style="width: 100%;">
            <tr>
                <td colspan="3"><label class="lbl-header">Settings</label></td>
            </tr>
            <tr>
                <td style="width: 50%">
                    <div class="input-group input-group-sm" title="Global Show" style="margin-bottom: 3px">
                        <span class="input-group-addon addon-74p" style="font-weight: bold">Fog:</span>
                        <div class="form-control input-sm">
                            <input type="range" min="0" max="1" step="0.1" id="numGlobalShow" value="0" oninput="ResetCanvas()" />
                        </div>
                    </div>
                </td>
                <td style="width: 8px">&nbsp;</td>
                <td>
                    <div id="divShowGrid"></div>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="input-group input-group-sm" style="margin-bottom: 3px">
                        <div class="input-group-btn">
                            <a class="btn btn-default" onclick="LoadBackground()" title="Background">
                                <i class="glyphicon glyphicon-picture"></i>&nbsp;Background
                            </a>
                            <a class="btn btn-default" onclick="LoadParallax()" title="Parallax">
                                <i class="glyphicon glyphicon-picture"></i>&nbsp;Parallax
                            </a>
                        </div>
                    </div>
                </td>
                <td></td>
                <td>
                    <div id="divHorizontal"></div>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="input-group input-group-sm" style="margin-bottom: 5px">
                        <div class="input-group-btn">
                            <a class="btn btn-default" style="width: 100%" onclick="ResetAdjusts()" title="Reset">
                                <i class="glyphicon glyphicon-refresh"></i>&nbsp;Reset Settings
                            </a>
                        </div>
                    </div>
                </td>
                <td></td>
                <td>
                    <div id="divShowCoords"></div>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="input-group input-group-sm" title="Background Color">
                        <span class="input-group-addon addon-60p" style="font-weight: bold">BC:</span>
                        <input type="color" class="form-control input-sm" id="numColorBk" value="#000000" oninput="ResetCanvas()" />
                    </div>
                </td>
                <td></td>
                <td>
                    <div class="input-group input-group-sm" title="Grid Color">
                        <span class="input-group-addon addon-60p" style="font-weight: bold">GC:</span>
                        <input type="color" class="form-control input-sm" id="numColor" value="#ff0000" oninput="ResetCanvas()" />
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="input-group input-group-sm">
                        <span class="input-group-addon addon-60p" style="font-weight: bold">Box:</span>
                        <input type="number" class="form-control input-sm" min="48" max="128" step="1" id="numBox" value="96" lazyblur="ResetCanvas()" />
                        <div class="input-group-btn">
                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span></button>
                            <ul class="dropdown-menu" style="min-width: 50px !important;">
                                <li><a onclick="SetBoxValue('48')">48</a></li>
                                <li><a onclick="SetBoxValue('72')">72</a></li>
                                <li><a onclick="SetBoxValue('96')">96</a></li>
                            </ul>
                        </div>
                    </div>
                </td>
                <td></td>
                <td>
                    <div class="input-group input-group-sm">
                        <span class="input-group-addon addon-60p" style="font-weight: bold">Zoom:</span>
                        <input type="number" class="form-control input-sm" min="-5" max="5" step=".01" id="numCompZ" value="1" onchange="SetCanvasZoom()" pattern="^\d*(\.\d{0,2})?$" />
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="input-group input-group-sm" title="Background Complement X">
                        <span class="input-group-addon addon-60p" style="font-weight: bold">CX:</span>
                        <input type="number" class="form-control input-sm" min="-100" max="100" id="numCompX" value="0" lazyblur="ResetCanvas()" />
                    </div>
                </td>
                <td></td>
                <td>
                    <div class="input-group input-group-sm" title="Background Complement Y">
                        <span class="input-group-addon addon-60p" style="font-weight: bold">CY:</span>
                        <input type="number" class="form-control input-sm" min="-100" max="100" id="numCompY" value="0" lazyblur="ResetCanvas()" />
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="3">
                    <div style="margin-top: 8px"></div>
                    <label class="lbl-header">Parallax Settings</label>
                </td>
            </tr>
            <tr>
                <td><div id="divParallaxAnim"></div></td>
                <td></td>
                <td><div id="divParallaxRtl"></div></td>
            </tr>
            <tr>
                <td><div id="divParallaxVertical"></div></td>
                <td></td>
                <td><div id="divParallaxStretch"></div></td>
            </tr>
            <tr>
                <td>
                    <div class="input-group input-group-sm">
                        <span class="input-group-addon addon-60p" style="font-weight: bold">Speed:</span>
                        <input type="number" class="form-control input-sm" min="-5" max="5" step=".01" id="numkParallaxSpeed" value="2" onchange="ResetCanvas()" />
                    </div>
                </td>
                <td></td>
                <td>
                    <div class="input-group input-group-sm" title="Parallax Complement X">
                        <span class="input-group-addon addon-60p" style="font-weight: bold">CX:</span>
                        <input type="number" class="form-control input-sm" min="-100" max="100" id="numParallaxX" value="0" lazyblur="ResetCanvas()" />
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="input-group input-group-sm" title="Parallax Complement Y">
                        <span class="input-group-addon addon-60p" style="font-weight: bold">CY:</span>
                        <input type="number" class="form-control input-sm" min="-100" max="100" id="numParallaxY" value="0" lazyblur="ResetCanvas()" />
                    </div>
                </td>
                <td></td>
                <td>
                    <div class="input-group input-group-sm">
                        <span class="input-group-addon addon-74p" style="font-weight: bold">Opacity:</span>
                        <div class="form-control input-sm">
                            <input type="range" min="0" max="1" step="0.1" id="numParallaxOp" value="1" oninput="ResetCanvas()" />
                        </div>
                    </div>
                </td>
            </tr>
        </table>
    </div>

    <div class="content">
        <canvas id="baseCanvas" style="width: calc(100%); height: calc(100%);"></canvas>
    </div>
</body>
</html>